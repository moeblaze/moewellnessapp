<!doctype html><html lang="en"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AI Coach — Moe Community Wellness</title>
<link rel="stylesheet" href="styles.css"/>
<meta property="og:title" content="AI Coach — Moe">
<meta property="og:description" content="Ask wellness and red/NIR questions. Educational only.">
<meta property="og:image" content="assets/images/banner-1200x628.png">
<meta name="twitter:card" content="summary_large_image">
<link rel="icon" href="assets/icons/icon-192.png">
</head>
<body class="plaid-bg">
<header class="nav"><div class="row">
  <div class="brand"><div class="logo" style="width:28px;height:28px;background:url(assets/images/og-index.png) center/cover"></div><div class="brand-name">Moe Community Wellness</div><span class="badge">Coach</span></div>
  <nav><a href="index.html">Home</a><a href="oscillator.html">Oscillator</a><a href="blog/index.html">Blog</a><a href="resources/index.html">Resources</a><a href="coach.html">Coach</a></nav>
</div></header>
<main class="container section">
  <div class="card" style="max-width:900px;margin:0 auto">
    <div class="name">Moe AI Coach</div>
    <div class="small">Ask about tones, red/NIR education, and safe best practices. This is <strong>educational</strong> and not medical advice.</div>
    <div id="chat" style="margin-top:10px; display:flex; flex-direction:column; gap:8px"></div>
    <form id="coachForm" onsubmit="return false" style="display:flex;gap:8px;flex-wrap:wrap;margin-top:10px">
      <input id="coachInput" placeholder="Ask a question..." style="flex:1;min-width:260px"/>
      <button class="btn" id="coachSend">Send</button>
    </form>
    <div id="coachMsg" class="small" style="margin-top:6px"></div>
  </div>
</main>
<footer><div class="container small">© Moe Community Cloud</div></footer>

<script>
const chat = document.getElementById('chat');
const input = document.getElementById('coachInput');
const msg = document.getElementById('coachMsg');

function addBubble(role, text){
  const div = document.createElement('div');
  div.className = 'card ' + (role === 'user' ? '' : 'alt');
  div.innerHTML = `<div class="small"><strong>${role === 'user' ? 'You' : 'Coach'}</strong></div><div>${text.replaceAll('<','&lt;')}</div>`;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

async function send(){
  const q = input.value.trim();
  if(!q) return;
  addBubble('user', q);
  input.value='';
  msg.textContent = 'Thinking...';
  try {
    const r = await fetch('api/coach', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ prompt: q })
    });
    if(!r.ok){ const t = await r.text(); throw new Error(t||('HTTP '+r.status)); }
    const data = await r.json();
    addBubble('assistant', data.reply || '(no reply)');
    msg.textContent = '';
  } catch(e){
    msg.textContent = 'Error: ' + (e.message || 'request failed');
  }
}
document.getElementById('coachSend').addEventListener('click', send);
input.addEventListener('keydown', e=>{ if(e.key==='Enter'){ e.preventDefault(); send(); } });
</script>
</body></html>
